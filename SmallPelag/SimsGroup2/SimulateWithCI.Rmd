---
title: "Simulating sampling schemes for Estonia"
author: "Richard Meitern"
date: "7/9/2020"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

This file is for demonstrating the new simulation function that incorporates Coeficent Intervals generation. The work is based on previous script "Sims_Sampling.r". The code in directory "R" is refractored from "Sims_Sampling.r". Refactoring might have braked some functionality, ie some things might not work as expected (or not at all). Also most functions are lackng documentation (some is present below and also in function heads).

```{r}
#load your private data for actual simuations
privateDataFile <- "../../../privateData/rcgEE2019.Rdata"
load(privateDataFile)
```


## Simulations

```{r}

#load functions
source('./R/validators.R')
source('./R/simulators.R')

#loading required packages that are not present in base r
#library(data.table)

```


```{r}
#----------------Options----------------------	
#setting it for consistent results for real simulations good to remove it
set.seed(123)

# withinTripSampUnit
# this is what will be sampled withinTrip
withinTripSampUnit <- "haulId" # alternative: "fishdayId"
			
# withinTripSampMethod	
withinTripSampMethod <- "all_hauls"
# alternative: "first_haul", "last_haul", "srswor_haul"
		
# sppSelectMethod
sppSelectMethod <- "alternative_2"
# alternative: "alternative_1", "alternative_2", "alternative_3", and so on
target_spp<-c("Sprattus sprattus", "Clupea harengus")
# if not NULL keep only selected species
sign_prop <- 0.3 # only for alternative 3
		
# subsampleHaulsPerSubdivision	
subsampleHaulsPerArea<- TRUE # alternative: TRUE, FALSE
nHaulsMaxPerArea<-2
			
# creates withinTripSampUnit column
keep_areas <-  c("27.3.d.28.1", "27.3.d.28.2", "27.3.d.29", "27.3.d.32")

#-----------Validate data format ----------
testData<- checkInputDataValidity(rcgEE2019, withinTripSampUnit = "haulId" )
target_list <- NULL #vessel names to sample if NULL samples all

# ======================
# example of simulation
# ======================
res <- simulateSampling(data = testData,
                        refusals = 20,
                        sppSelectMethod = sppSelectMethod,
                        target_vessels = target_list,
                        target_spp = target_spp,
                        keep_areas = keep_areas,
                        withinTripSampMethod = withinTripSampMethod,
                        withinTripSampUnit = withinTripSampUnit,
                        n_vessels = 5,
                        n_sims = 10,
                        print_tables = T)

```




```{r}

```



































